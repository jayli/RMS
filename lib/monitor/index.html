<!doctype html>
<html>
    <head>
        <meta charset="utf8" />
        <title>RMS Monitor</title>
        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.1/jquery.min.js" type="text/javascript"></script>
        <script src='http://a.tbcdn.cn/apps/tms/rms/??socket.io.js,highcharts.js'></script>
        <script>
            var socket = io.connect('http://trade.ued.taobao.net:8089');
            $(document).ready(function() {
                var chart = new Highcharts.Chart({
                    chart: {
                        renderTo: 'container',
                        defaultSeriesType: 'spline'
                    },
                    title: {
                        text: 'RMS Monitor'
                    },
                    series: [{
                        name: 'rss',
                        data: []
                    }, {
                        name: 'vsize',
                        data: []
                    }, {
                        name: 'heapTotal',
                        data: []
                    }, {
                        name: 'heapUsed',
                        data: []
                    }]
                });

                function addPoint(data, point, shift) {
                    chart.series[point-1].addPoint([+data[0], +data[point]/1048576], true, shift);
                }

                socket.on('data', function (data) {
                    console.log(data);
                    var series = chart.series[0];
                    var shift = series.data.length > 20;
                    addPoint(data, 1, shift);
                    addPoint(data, 2, shift);
                    addPoint(data, 3, shift);
                    addPoint(data, 4, shift);
                });
            });
        </script>
    </head>

    <body>
        <div id="container" style="width: 800px; height: 400px;"></div>
    </body>
</html>

